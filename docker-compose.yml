version: '3.8'

services:
  yiaps:
    build: .
    image: yiaps:latest
    container_name: youtube_insight_system
    ports:
      - "8080:8080"
    volumes:
      - .:/app
      - /Users/a1234/.ssh:/root/.ssh:ro # For Git Push (Optional)
    environment:
      - PYTHONUNBUFFERED=1
    # Keep container running for exec or cron usage if needed, or run once.
    # For initial auth, we run specifically instructions.
    command: python fetch_data.py

  dashboard:
    image: node:20-alpine
    container_name: youtube_dashboard
    working_dir: /app
    ports:
      - "5173:5173"
    volumes:
      - ./dashboard:/app
      - /app/node_modules
      - ./dashboard_data.json:/app/public/dashboard_data.json
    command: sh -c "npm install && npm run dev -- --host"
